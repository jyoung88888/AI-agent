# ì¼ì£¼ AI Agent (Iljoo AI Agent)

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

**ì¼ì£¼ AI Agent**ëŠ” ë¬¸ì„œ ë¶„ì„, ì •ë³´ ì¶”ì¶œ, ê·¸ë¦¬ê³  ì‹¤ì‹œê°„ ë°ì´í„° í†µí•©ì„ í†µí•´ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì‚¬ê²°ì •ì„ ì§€ì›í•˜ëŠ” ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ AI ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ëŠ¥
- ğŸ“„ **ë¬¸ì„œ ìš”ì•½ ë° ë¶„ì„**: ê³µê³ ë¬¸, ì‚¬ì—…ê³„íšì„œ ë“± ëŒ€ìš©ëŸ‰ ë¬¸ì„œì˜ í•µì‹¬ ë‚´ìš© ìë™ ìš”ì•½
- ğŸ” **RAG ê¸°ë°˜ Q&A**: ì—…ë¡œë“œëœ ë¬¸ì„œì— ëŒ€í•œ ì •í™•í•œ ì§ˆì˜ì‘ë‹µ ì œê³µ
- ğŸ“Š **êµ¬ì¡°í™”ëœ ì •ë³´ ì¶”ì¶œ**: JSON í˜•ì‹ì˜ ì²´ê³„ì ì¸ ì •ë³´ ì¶”ì¶œ
- ğŸŒ¤ï¸ **ì‹¤ì‹œê°„ ë‚ ì”¨ ì—°ë™**: ê¸°ìƒì²­ APIë¥¼ í†µí•œ ì§€ì—­ë³„ ë‚ ì”¨ ì •ë³´ ë° ì¶”ì²œ
- ğŸ¤– **í•˜ì´ë¸Œë¦¬ë“œ LLM êµ¬ì¡°**: ë¡œì»¬ ëª¨ë¸ê³¼ í´ë¼ìš°ë“œ APIì˜ ìµœì  ì¡°í•©

---

## ğŸ¯ ê°œë°œ ëª©í‘œ

1. **ë¬¸ì„œ ê¸°ë°˜ ì˜ì‚¬ê²°ì • ì§€ì›**
   - ê³µê³ ë¬¸ ë° ì‚¬ì—…ê³„íšì„œì˜ í•µì‹¬ ë‚´ìš© ìë™ ìš”ì•½
   - ê³¼ì œ ì‹ ì²­ ì‹œ í•„ìš”í•œ ì •ë³´ë¥¼ êµ¬ì¡°í™”ë˜ì–´ ì œê³µ

2. **ì§€ì—­ ë§ì¶¤í˜• ì •ë³´ ì œê³µ**
   - ì‹¤ì‹œê°„ ë‚ ì”¨ ê¸°ë°˜ ìƒí™œ ì •ë³´ ì œê³µ
   - ì§€ì—­ë³„ ë§ì¶¤ ì¶”ì²œ

3. **ì—”í„°í”„ë¼ì´ì¦ˆ ì•ˆì •ì„±**
   - LangGraphë¥¼ í†µí•œ ìƒíƒœ ê´€ë¦¬
   - ë©”ëª¨ë¦¬ ì§€ì†ì„± ë° ëŒ€í™” ë§¥ë½ ìœ ì§€

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Streamlit Frontend                      â”‚
â”‚              (iljoo_ai_agent_main.py)                    â”‚
â”‚  - ë¬¸ì„œ ì—…ë¡œë“œ                                             â”‚
â”‚  - ë‹¤ì¤‘ ì‘ì—… ëª¨ë“œ (ìš”ì•½/QA/JSON)                          â”‚
â”‚  - ë‚ ì”¨ ì¡°íšŒ                                              â”‚
â”‚  - ì‹¤ì‹œê°„ ëŒ€í™”                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP Requests
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 FastAPI Backend                           â”‚
â”‚                  (api.py)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         Weather API Endpoint                        â”‚ â”‚
â”‚  â”‚  - ì§€ì—­ëª… ì¶”ì¶œ (GPT-4o-mini)                       â”‚ â”‚
â”‚  â”‚  - ê¸°ìƒì²­ API í˜¸ì¶œ                                 â”‚ â”‚
â”‚  â”‚  - ë‚ ì”¨ ê¸°ë°˜ ì¶”ì²œ ìƒì„±                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         RAG Chat Endpoint                           â”‚ â”‚
â”‚  â”‚  - PDF ì—…ë¡œë“œ ë° ì²˜ë¦¬                              â”‚ â”‚
â”‚  â”‚  - í…ìŠ¤íŠ¸ ì²­í‚¹ ë° ì„ë² ë”©                           â”‚ â”‚
â”‚  â”‚  - ë‹¤ì¤‘ ì‘ì—… ëª¨ë“œ (ìš”ì•½/QA/JSON)                  â”‚ â”‚
â”‚  â”‚  - LangGraph ì›Œí¬í”Œë¡œìš° ì‹¤í–‰                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                  â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Local LLM    â”‚              â”‚  OpenAI API    â”‚
    â”‚  Llama 3.2    â”‚              â”‚  GPT-4o-mini   â”‚
    â”‚  (ë¡œì»¬ GPU)    â”‚              â”‚  (í´ë¼ìš°ë“œ)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   FAISS Vector DB     â”‚
    â”‚  (ë¬¸ì„œ ì„ë² ë”© ì €ì¥)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ
- **Framework**: FastAPI 0.115.6
- **ì›¹ì„œë²„**: Uvicorn 0.34.0
- **API í´ë¼ì´ì–¸íŠ¸**: OpenAI 1.59.4

### LLM & ì„ë² ë”©
- **ë¡œì»¬ LLM**: Llama 3.2 Korean (3B parameters)
  - ëª¨ë¸ëª…: `iljoo/models-iljoodeephub-Bllossom-llama-3.2-Korean-Bllossom-3B_bf16_lr64_qlr4_test2`
  - ìµœëŒ€ í† í°: 256
  - ì˜¨ë„: 0.1 (ê²°ì •ë¡ ì )

- **í´ë¼ìš°ë“œ LLM**: GPT-4o-mini (OpenAI)
  - ìš©ë„: ì§€ì—­ëª… ì¶”ì¶œ, ë‚ ì”¨ ê¸°ë°˜ ì¶”ì²œ
  - ì˜¨ë„: 0.0 (ì™„ì „ ê²°ì •ë¡ ì )

- **ì„ë² ë”© ëª¨ë¸**: OpenAI text-embedding-ada-002
  - ì°¨ì›: 1536
  - ë‹¤êµ­ì–´ ì§€ì›

### ë²¡í„° DB & ë¬¸ì„œ ì²˜ë¦¬
- **ë²¡í„° ì €ì¥ì†Œ**: FAISS (Facebook AI Similarity Search)
- **ë¬¸ì„œ ë¡œë”**: PyMuPDF, PyPDFLoader
- **í…ìŠ¤íŠ¸ ë¶„í• **: CharacterTextSplitter
  - ì²­í¬ í¬ê¸°: 200 í† í°
  - ì¤‘ë³µ: 50 í† í°

### ì›Œí¬í”Œë¡œìš° & ìƒíƒœ ê´€ë¦¬
- **LangGraph**: 0.2.65
  - StateGraph ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°
  - MemorySaverë¡œ ëŒ€í™” ì§€ì†ì„± ê´€ë¦¬
  - ë©”ì‹œì§€ íŠ¸ë¦¼ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš° ê´€ë¦¬

### í”„ë¡ íŠ¸ì—”ë“œ
- **UI Framework**: Streamlit 1.41.1
- **Python**: 3.10+
- **Deep Learning**: PyTorch 2.5.1 (CUDA 12.1 ì§€ì›)

### ì™¸ë¶€ API
- **ë‚ ì”¨ ë°ì´í„°**: ê¸°ìƒì²­ (ì´ˆë‹¨ê¸°ì‹¤í™© API)
- **LLM API**: OpenAI (GPT-4o-mini)

---

## ğŸ“¦ ì„¤ì¹˜ ë° í™˜ê²½ ì„¤ì •

### 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ì„ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ìƒì„±í•˜ê³  ë‹¤ìŒì„ ì…ë ¥í•˜ì„¸ìš”:

```bash
# OpenAI API
OPENAI_API_KEY=your_openai_api_key_here

# ê¸°ìƒì²­ API (ë‚ ì”¨ ì¡°íšŒìš©)
WEATHER_API_KEY=your_weather_api_key_here

# HuggingFace Token (ë¡œì»¬ ëª¨ë¸ ë‹¤ìš´ë¡œë“œìš©)
HF_TOKEN=your_huggingface_token_here
```

### 2. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

```bash
pip install -r requirements.txt
```

### 3. HuggingFace ëª¨ë¸ ë‹¤ìš´ë¡œë“œ

```bash
python -c "from transformers import AutoTokenizer, AutoModelForCausalLM;
tokenizer = AutoTokenizer.from_pretrained('iljoo/models-iljoodeephub-Bllossom-llama-3.2-Korean-Bllossom-3B_bf16_lr64_qlr4_test2')
model = AutoModelForCausalLM.from_pretrained('iljoo/models-iljoodeephub-Bllossom-llama-3.2-Korean-Bllossom-3B_bf16_lr64_qlr4_test2', device_map='auto')"
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. FastAPI ë°±ì—”ë“œ ì‹¤í–‰

```bash
uvicorn api:app --reload --port 8000
```

ì¶œë ¥ ì˜ˆì‹œ:
```
INFO:     Uvicorn running on http://127.0.0.1:8000
INFO:     Application startup complete
```

Swagger UI ì ‘ê·¼: http://127.0.0.1:8000/docs

### 2. Streamlit í”„ë¡ íŠ¸ì—”ë“œ ì‹¤í–‰ (ë³„ë„ í„°ë¯¸ë„)

```bash
streamlit run iljoo_ai_agent_main.py
```

ì¶œë ¥ ì˜ˆì‹œ:
```
  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
```

---

## ğŸ“š API ì—”ë“œí¬ì¸íŠ¸ ìƒì„¸ ì„¤ëª…

### 1. ë‚ ì”¨ ì¡°íšŒ ë° ì¶”ì²œ

**ì—”ë“œí¬ì¸íŠ¸**: `POST /iljoo_ai_agent/weather`

**ìš”ì²­ ì˜ˆì‹œ**:
```bash
curl -X POST "http://127.0.0.1:8000/iljoo_ai_agent/weather?question=ë¶€ì‚°ì˜%20ë‚ ì”¨ëŠ”%20ì–´ë•Œ"
```

**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "response": "ë¶€ì‚°ê´‘ì—­ì‹œì˜ í˜„ì¬ ë‚ ì”¨ ì •ë³´:\n- ê¸°ì˜¨: 15.2Â°C\n- í’ì†: 3.5m/s\n- ìŠµë„: 65%\n\nì¶”ì²œ ì‚¬í•­:\ní˜„ì¬ ë‚ ì”¨ëŠ” ì¾Œì í•©ë‹ˆë‹¤. ì–‡ì€ ê²¹ê²¹ì´ì˜·ì„ ì¶”ì²œí•©ë‹ˆë‹¤."
}
```

**ë™ì‘ ì›ë¦¬**:
1. ì‚¬ìš©ì ì§ˆë¬¸ì—ì„œ GPT-4o-minië¡œ ì§€ì—­ëª… ì¶”ì¶œ
2. ì§€ì—­ ì¢Œí‘œë¥¼ ì´ìš©í•´ ê¸°ìƒì²­ ì´ˆë‹¨ê¸°ì‹¤í™© API í˜¸ì¶œ
3. ë‚ ì”¨ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œ ë©”ì‹œì§€ ìƒì„±

**ì§€ì› ì§€ì—­**: ë¶€ì‚°ê´‘ì—­ì‹œ (ì „ì²´ ë° êµ¬ë³„), ì„œìš¸, ì¸ì²œ, ëŒ€ì „, ê´‘ì£¼, ëŒ€êµ¬, ìš¸ì‚°, ì„¸ì¢…, ê²½ê¸°ë„, ê°•ì›ë„, ì¶©ì²­ë¶ë„, ì¶©ì²­ë‚¨ë„, ì „ë¼ë¶ë„, ì „ë¼ë‚¨ë„, ê²½ìƒë¶ë„, ê²½ìƒë‚¨ë„, ì œì£¼ë„

---

### 2. RAG ê¸°ë°˜ ë¬¸ì„œ Q&A

**ì—”ë“œí¬ì¸íŠ¸**: `POST /iljoo_ai_agent/chat`

**ìš”ì²­ ì˜ˆì‹œ**:
```bash
curl -X POST "http://127.0.0.1:8000/iljoo_ai_agent/chat" \
  -H "Content-Type: application/json" \
  -d '{
    "user_input": "ì´ ë¬¸ì„œì˜ ì£¼ìš” ë‚´ìš©ì€?",
    "task": "summary"
  }'
```

**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "user_input": "ì´ ë¬¸ì„œì˜ ì£¼ìš” ë‚´ìš©ì€?",
  "task": "summary",
  "response": "ì´ ê³µê³ ë¬¸ì˜ ì£¼ìš” ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n1. ëª¨ì§‘ ëŒ€ìƒ: ê²½ë ¥ 3ë…„ ì´ìƒì˜ AI/ML ì—”ì§€ë‹ˆì–´\n2. ì±„ìš© ì§ë¬´: ..."
}
```

**ì‘ì—… ëª¨ë“œ**:

| ëª¨ë“œ | task íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|------|-------------|------|
| ìš”ì•½ | `summary` | ë¬¸ì„œì˜ í•µì‹¬ ë‚´ìš©ì„ êµ¬ì¡°í™”ëœ í•­ëª©ë³„ë¡œ ìš”ì•½ |
| Q&A | `qa` | ì—…ë¡œë“œëœ ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚¬ìš©ì ì§ˆë¬¸ì— ë‹µë³€ |
| JSON | `json` | ë¬¸ì„œ ë‚´ìš©ì„ êµ¬ì¡°í™”ëœ JSON í˜•ì‹ìœ¼ë¡œ ì¶”ì¶œ |

**JSON ì¶œë ¥ ì˜ˆì‹œ** (task: "json"):
```json
{
  "ê³µê³ ëª…": "2024ë…„ AI ì—”ì§€ë‹ˆì–´ ì±„ìš©ê³µê³ ",
  "ê³µê³ ê¸°ê´€": "ê¸°ìˆ íšŒì‚¬ A",
  "ëª¨ì§‘ë¶„ì•¼": {
    "ì§ë¬´": "AI/ML ì—”ì§€ë‹ˆì–´",
    "ê²½ë ¥": "3ë…„ ì´ìƒ",
    "ì¸ì›": "5ëª…"
  },
  "ì§€ì›ìê²©": ["ì„ì‚¬ ì´ìƒ", "Python ê²½í—˜", "PyTorch/TensorFlow ê²½í—˜"],
  "ì œì¶œì„œë¥˜": ["ì´ë ¥ì„œ", "ìê¸°ì†Œê°œì„œ", "í¬íŠ¸í´ë¦¬ì˜¤"]
}
```

---

### 3. PDF íŒŒì¼ ì—…ë¡œë“œ

**ì—”ë“œí¬ì¸íŠ¸**: `POST /iljoo_ai_agent/upload_pdf`

**ìš”ì²­ ì˜ˆì‹œ**:
```bash
curl -X POST "http://127.0.0.1:8000/iljoo_ai_agent/upload_pdf" \
  -F "file=@document.pdf"
```

**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "message": "PDF uploaded and processed successfully."
}
```

**ì²˜ë¦¬ ê³¼ì •**:
1. ì„ì‹œ íŒŒì¼ë¡œ PDF ì €ì¥
2. PyMuPDFë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
3. ë¬¸ì„œ ì²­í‚¹ ë° ì„ë² ë”© ìƒì„±
4. FAISS ë²¡í„° DB êµ¬ì¶•
5. ì„ì‹œ íŒŒì¼ ì‚­ì œ

---

## ğŸ’» Streamlit UI ì‚¬ìš©ë²•

### ë©”ì¸ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Iljoo AI Agent                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  [ëŒ€í™” ê¸°ë¡]                              â”‚
â”‚  User: ê³µê³ ë¬¸ ìš”ì•½í•´ì¤˜                   â”‚
â”‚  Assistant: ì£¼ìš” ë‚´ìš©ì€...               â”‚
â”‚                                          â”‚
â”‚  [ì…ë ¥ì°½] ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”:             â”‚
â”‚                                          â”‚
â”‚  [ì „ì²´ ëŒ€í™” ì‚­ì œ] ë²„íŠ¼                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‚¬ìš© ì˜ˆì‹œ

1. **ë¬¸ì„œ ì—…ë¡œë“œ**
   - PDF íŒŒì¼ ì„ íƒ ë° ì—…ë¡œë“œ

2. **ë¬¸ì„œ ìš”ì•½ ìš”ì²­**
   ```
   ì‚¬ìš©ì: "ì´ ê³µê³ ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì„ ìš”ì•½í•´ì¤˜"
   â†’ task: "summary"ë¡œ API í˜¸ì¶œ
   â†’ êµ¬ì¡°í™”ëœ ìš”ì•½ ë°˜í™˜
   ```

3. **Q&A ëª¨ë“œ**
   ```
   ì‚¬ìš©ì: "ì§€ì› ìê²©ì´ ë­ì•¼?"
   â†’ task: "qa"ë¡œ API í˜¸ì¶œ
   â†’ ë¬¸ì„œ ê¸°ë°˜ ë‹µë³€ ë°˜í™˜
   ```

4. **JSON ì¶”ì¶œ**
   ```
   ì‚¬ìš©ì: "ëª¨ë“  ì •ë³´ë¥¼ JSONìœ¼ë¡œ ì •ë¦¬í•´ì¤˜"
   â†’ task: "json"ë¡œ API í˜¸ì¶œ
   â†’ êµ¬ì¡°í™”ëœ JSON ë°˜í™˜
   ```

5. **ë‚ ì”¨ ì¡°íšŒ**
   ```
   ì‚¬ìš©ì: "ì„œìš¸ ë‚ ì”¨ ì–´ë•Œ?"
   â†’ weather API í˜¸ì¶œ
   â†’ ë‚ ì”¨ ì •ë³´ ë° ì¶”ì²œ ë°˜í™˜
   ```

---

## ğŸ”‘ í•µì‹¬ ì½”ë“œ ì„¤ëª…

### 1. RAG íŒŒì´í”„ë¼ì¸ (api.py)

```python
def RAG_pipeline(doc):
    # í…ìŠ¤íŠ¸ ì²­í‚¹: 200í† í° ë‹¨ìœ„, 50í† í° ì¤‘ë³µ
    text_splitter = CharacterTextSplitter(chunk_size=200, chunk_overlap=50)
    data = text_splitter.split_documents(doc)

    # OpenAI ì„ë² ë”© ìƒì„±
    embeddings = OpenAIEmbeddings(model="text-embedding-ada-002")

    # FAISS ë²¡í„° DB êµ¬ì¶•
    vector_store = FAISS.from_documents(data, embeddings)
    return vector_store
```

### 2. LangGraph ì›Œí¬í”Œë¡œìš°

```python
class RAG_ChatBot:
    def chat(self, call_model, user_input: str, task):
        # StateGraph ìƒì„±
        workflow = StateGraph(state_schema=MessagesState)

        # ë…¸ë“œ ì¶”ê°€ (taskë³„ë¡œ ë‹¤ë¥¸ í”„ë¡¬í”„íŠ¸ ì‚¬ìš©)
        workflow.add_node("model",
            lambda state: self.call_model(state, task_prompt[task]))

        # ë©”ëª¨ë¦¬ ì €ì¥ì†Œ ì„¤ì •
        memory = MemorySaver()
        app = workflow.compile(checkpointer=memory)

        # ìŠ¤íŠ¸ë¦¼ ì‹¤í–‰
        for event in app.stream({"messages": [input_message]}, config):
            answer = event["messages"][-1]

        return answer.content
```

### 3. ì§€ì—­ëª… ì¶”ì¶œ (api.py)

```python
def extract_location_from_question(question):
    """
    ì‚¬ìš©ì ì§ˆë¬¸ì—ì„œ ì§€ì—­ëª…ì„ GPTë¡œ ì¶”ì¶œ
    """
    prompt = f"""
    Question: "{question}"
    REGION_COORDS: {list(REGION_COORDS.keys())}

    ê°€ì¥ êµ¬ì²´ì ì¸ ì§€ì—­ëª…ë§Œ ë°˜í™˜í•˜ì„¸ìš” (êµ¬ > êµ° > ì‹œ)
    """

    response = client.chat.completions.create(
        model="gpt-4o-mini",
        messages=[{"role": "user", "content": prompt}],
        temperature=0.0
    )

    location = response.choices[0].message.content.strip()
    return location if location in REGION_COORDS else None
```

### 4. ë©”ì‹œì§€ íŠ¸ë¦¼ (iljoo_ai_agent_main.py)

```python
def trim_conversation_history(messages, k=5):
    """
    ìµœê·¼ kê°œ ë©”ì‹œì§€ë§Œ ìœ ì§€ (í† í° ì ˆê°)
    """
    return trim_messages(
        messages,
        token_counter=len,
        max_tokens=k,
        strategy="last",
        start_on="human",
        include_system=True
    )
```

---

## âš™ï¸ ì£¼ìš” íŒŒë¼ë¯¸í„° ì„¤ì •

### LLM íŒŒë¼ë¯¸í„°

```python
# ë¡œì»¬ Llama 3.2
max_new_tokens=256          # ìµœëŒ€ ìƒì„± í† í°
temperature=0.1             # ë‚®ì„ìˆ˜ë¡ ê²°ì •ë¡ ì 
top_p=0.1                   # í™•ë¥  ìƒ˜í”Œë§

# OpenAI GPT-4o-mini
temperature=0.0             # ì™„ì „ ê²°ì •ë¡ ì 
max_tokens=100~150          # ì‘ì—…ë³„ë¡œ ìƒì´
```

### ë²¡í„° DB íŒŒë¼ë¯¸í„°

```python
chunk_size=200              # í•œ ì²­í¬ì˜ í† í° ìˆ˜
chunk_overlap=50            # ì²­í¬ ê°„ ì¤‘ë³µ
retriever_k=50              # ê²€ìƒ‰í•  ìƒìœ„ ë¬¸ì„œ ìˆ˜
```

### ë©”ì‹œì§€ ê´€ë¦¬

```python
trim_max_tokens=5           # ìœ ì§€í•  ìµœê·¼ ë©”ì‹œì§€ ê°œìˆ˜
thread_id=uuid.uuid4()      # ì„¸ì…˜ë³„ ê³ ìœ  ID
```

---

## ğŸ› ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### 1. OpenAI API ì—ëŸ¬
```
Error: Invalid API key
```
**í•´ê²°**: `.env` íŒŒì¼ì—ì„œ `OPENAI_API_KEY` í™•ì¸

### 2. ê¸°ìƒì²­ API ì—ëŸ¬
```
Error: HTTP Error: 400
```
**í•´ê²°**:
- `WEATHER_API_KEY` í™•ì¸
- ì˜¬ë°”ë¥¸ ì§€ì—­ëª… ì…ë ¥ í™•ì¸

### 3. GPU ë©”ëª¨ë¦¬ ë¶€ì¡±
```
RuntimeError: CUDA out of memory
```
**í•´ê²°**:
- `device_map="auto"` í™•ì¸
- `offload_buffers=True` ì„¤ì •

### 4. PDF ì²˜ë¦¬ ì‹¤íŒ¨
```
Error: Failed to load PDF
```
**í•´ê²°**:
- PDF íŒŒì¼ í˜•ì‹ í™•ì¸
- ì•”í˜¸í™”ë˜ì§€ ì•Šì€ PDF ì‚¬ìš©

### 5. ëŠë¦° ì‘ë‹µ ì†ë„
**ê°œì„  ë°©ì•ˆ**:
- Cross-Encoder ì¬ë­í‚¹ í™œì„±í™” (ì£¼ì„ í•´ì œ)
  ```python
  self.reranker_model = HuggingFaceCrossEncoder(
      model_name="BAAI/bge-reranker-v2-m3"
  )
  ```
- ì²­í¬ í¬ê¸° ì¡°ì •: `chunk_size=200` â†’ `chunk_size=300`
- ê²€ìƒ‰ ê°œìˆ˜ ê°ì†Œ: `k=50` â†’ `k=10`

---

## ğŸ“Š ì„±ëŠ¥ ìµœì í™” íŒ

### 1. ì¶”ë¡  ì†ë„ ê°œì„ 
- bfloat16 ì‚¬ìš©ìœ¼ë¡œ ë©”ëª¨ë¦¬ íš¨ìœ¨í™”
- ì˜¤í”„ë¡œë“œ ë²„í¼ í™œì„±í™”
- ë°°ì¹˜ ì²˜ë¦¬ êµ¬í˜„

### 2. ì •í™•ë„ ê°œì„ 
- ì²­í¬ í¬ê¸° ìµœì í™”
- í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§
- í•˜ì´ë¸Œë¦¬ë“œ ì„ë² ë”© (ì—¬ëŸ¬ ëª¨ë¸ ì¡°í•©)

### 3. ë¹„ìš© ì ˆê°
- ë¡œì»¬ Llama 3.2 ìš°ì„  ì‚¬ìš©
- OpenAI APIëŠ” í•„ìˆ˜ ì‘ì—…ë§Œ (ì§€ì—­ëª… ì¶”ì¶œ, ì¶”ì²œ)

---

## ğŸ” ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. API í‚¤ ê´€ë¦¬
- ì ˆëŒ€ ì½”ë“œì— ì§ì ‘ ì…ë ¥í•˜ì§€ ë§ ê²ƒ
- `.env` íŒŒì¼ ì‚¬ìš©
- `.gitignore`ì— `.env` ì¶”ê°€

```bash
# .gitignore
.env
*.env
```

### 2. PDF íŒŒì¼ ê²€ì¦
```python
# íŒŒì¼ í¬ê¸° ì œí•œ
if file.size > 50 * 1024 * 1024:  # 50MB ì œí•œ
    raise HTTPException(status_code=413, detail="File too large")

# íŒŒì¼ íƒ€ì… ê²€ì¦
if not file.filename.endswith(".pdf"):
    raise HTTPException(status_code=400, detail="Only PDF files allowed")
```

---

## ğŸš€ ë°°í¬ ê°€ì´ë“œ

### Docker ì»¨í…Œì´ë„ˆí™”

```dockerfile
FROM nvidia/cuda:12.1.0-devel-ubuntu22.04

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

EXPOSE 8000
EXPOSE 8501

CMD ["sh", "-c", "uvicorn api:app --host 0.0.0.0 --port 8000 & streamlit run iljoo_ai_agent_main.py --server.port 8501"]
```

### ì‹¤í–‰
```bash
docker build -t iljoo-ai-agent .
docker run --gpus all -p 8000:8000 -p 8501:8501 --env-file .env iljoo-ai-agent
```

---

## ğŸ”„ ì—…ë°ì´íŠ¸ ë¡œë“œë§µ

### V4.1 (ì˜ˆì •)
- [ ] Cross-Encoder ì¬ë­í‚¹ í™œì„±í™”
- [ ] ë‹¤ì¤‘ íŒŒì¼ ë™ì‹œ ì—…ë¡œë“œ
- [ ] ëŒ€í™” ì €ì¥ ë° ë¡œë“œ ê¸°ëŠ¥
- [ ] ì‚¬ìš©ìë³„ ì„¸ì…˜ ê´€ë¦¬

### V4.2 (ì˜ˆì •)
- [ ] ì´ë¯¸ì§€ ê¸°ë°˜ ë¬¸ì„œ ì²˜ë¦¬ (OCR)
- [ ] ìŒì„± ì…ì¶œë ¥ ì§€ì›
- [ ] ì‹¤ì‹œê°„ í˜‘ì—… ê¸°ëŠ¥

### V5.0 (ì˜ˆì •)
- [ ] ìì²´ ì„ë² ë”© ëª¨ë¸ í•™ìŠµ
- [ ] í•œêµ­ì–´ íŠ¹í™” ì—ì´ì „íŠ¸
- [ ] ì›¹ ìŠ¤í¬ë˜í•‘ í†µí•©

---

## ğŸ“ ë¼ì´ì„ ìŠ¤ ë° ì €ì‘ê¶Œ

ì´ í”„ë¡œì íŠ¸ëŠ” ê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤ ë° ì—°êµ¬ ëª©ì ìœ¼ë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.

### ì‚¬ìš©ëœ ì˜¤í”ˆì†ŒìŠ¤
- FastAPI: MIT License
- Streamlit: Apache 2.0
- LangChain: MIT License
- LangGraph: MIT License
- FAISS: MIT License
- PyTorch: BSD License
- Transformers: Apache 2.0

---

## ğŸ¤ ê¸°ì—¬ ë° í”¼ë“œë°±

ë¬¸ì œ ë³´ê³  ë° ê¸°ëŠ¥ ì œì•ˆì€ ì´ìŠˆ íƒ­ì—ì„œ ë°›ìŠµë‹ˆë‹¤.

---

## ğŸ“§ ì—°ë½ì²˜

í”„ë¡œì íŠ¸ì— ëŒ€í•œ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì—°ë½ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.

---

## ğŸ“ í•™ìŠµ ìë£Œ

### ì°¸ê³  ë…¼ë¬¸
- RAG (Retrieval-Augmented Generation): https://arxiv.org/abs/2005.11401
- LangGraph: https://langchain-ai.github.io/langgraph/
- FAISS: https://github.com/facebookresearch/faiss

### ì¶”ì²œ ë¦¬ì†ŒìŠ¤
- OpenAI API Documentation: https://platform.openai.com/docs
- HuggingFace Model Hub: https://huggingface.co/models
- LangChain Documentation: https://python.langchain.com/

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2024ë…„ 12ì›”
**ë²„ì „**: 4.0
